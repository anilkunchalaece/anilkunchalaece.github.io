<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Xnect - Installation and running demo &middot; Anil Kunchala
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <!-- <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Anil Kunchala
      </a>
    </div>
    <p class="lead">a <i> Tinkerers </i> log about his experiments with few things he came across</p>
  </header> -->

  <!-- Custom Photo and Links Section -->
  <div class="profile-section">
    <img src="http://localhost:4000/assets/images/Anil.png" alt="Anil Kunchala" class="profile-photo">
    <p class="profile-name">Anil Kunchala</p>
    <p class="profile-title">PhD Student at TU Dublin, Ireland</p>
    <ul class="profile-links">
      <li><a href="https://www.linkedin.com/in/anil-kunchala-aa9b2980" target="_blank"><i class="fab fa-linkedin"></i></a></li>
      <li><a href="https://github.com/anilkunchalaece" target="_blank"><i class="fab fa-github"></i></a></li>
      <li><a href="https://scholar.google.com/citations?user=8VpEQr8AAAAJ" target="_blank"><i class="fa-brands fa-google-scholar"></i></a></li>
      <li><a href="mailto:anilkunchalaece@gmail.com" target="_blank"><i class="fas fa-envelope"></i></a></li> 
      <!-- Add more links as needed -->
    </ul>
  </div>

  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Blog</a>
  
  

  

  


  
    
  

  

  

  
    
  

  
    
  

  
    
  

  
    
  

  


  


  
    
  

  

  

  
    
      <a class="category-link "
          href="/category/projects.html">Projects</a>
    
  

  
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/travel.html">Travel</a>
    
  

  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  

  <nav id="sidebar-icon-links">
  

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  &copy; Anil Kunchala
</p>

</div>

<!-- Add some CSS to style the new profile section -->
<style>
  .profile-section {
    text-align: center;
    margin: auto;
    margin-bottom: 40%;
  }
  .profile-photo {
    border-radius: 50%;
    width: 150px;
    height: 150px;
    margin: 0 auto;
  }
  .profile-name {
    font-size: 1.2em;
    font-weight: bold;
    margin: 10px 0;
  }
  .profile-title {
    font-size: 1em;
    margin-bottom: 10px;
  }
  .profile-links {
    list-style-type: none;
    padding: 0;
    display: flex;
    justify-content: center;
    gap: 15px; /* Space between the links */
  }
  .profile-links li {
    margin: 0;
  }
  .profile-links a {
    color: #007acc;
    text-decoration: none;
    display: flex;
    align-items: center;
    flex-direction: column; /* Arrange icon and text vertically */
  }
  .profile-links a:hover {
    text-decoration: underline;
  }
  .profile-links i {
    margin-bottom: 5px; /* Space between icon and text */
  }
</style>

    <main class="container">
      <header>
  <h1 class="post-title">Xnect - Installation and running demo</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">28 Oct 2020</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        Machine Learning
      
    
  </span>
</div>


  <div class="post-body">
    <p>In this Post I will show how to install <a href="https://gvv.mpi-inf.mpg.de/projects/XNect/">XNect</a> and Run the demo in C/C++ Library provided by xNect Team.</p>

<p>In summary you need to install following dependencies</p>
<ol>
  <li>OpenCV 3.4.11 - <em>recommended , dont use Opencv 4</em></li>
  <li>Protobuf</li>
  <li>Boost 1.58.0</li>
  <li>CUDA - <em>8 or 9 recommened but I tested with 10</em></li>
  <li>Caffe - <em>need to make few modifications before installation</em></li>
</ol>

<h4 id="machine-configuration">Machine Configuration</h4>
<p>I tested using machine with following configuration</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=19.10
DISTRIB_CODENAME=eoan
x86_64
Kernal - 5.3.0-64-generic 
</code></pre></div></div>

<p><img src="http://localhost:4000/assets/images/nvidia_info.jpg" alt="image" /></p>

<h4 id="1-installing-opencv-and-contrib-libs">1. installing openCV and contrib libs</h4>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  wget <span class="nt">-c</span>  <span class="nt">-O</span> opencv-3.4.11.tar.gz https://github.com/opencv/opencv/archive/3.4.11.tar.gz       
  <span class="nb">tar </span>xvzf opencv-3.4.11.tar.gz

  wget <span class="nt">-c</span> <span class="nt">-O</span> opencv_contrib-3.4.11 https://github.com/opencv/opencv_contrib/archive/3.4.11.tar.gz  
  <span class="nb">tar </span>xvzf opencv_contrib-3.4.11.tar.gz  

  <span class="nb">rm </span>opencv-3.4.11.tar.gz opencv_contrib-3.4.11.tar.gz

  <span class="nb">cd </span>opencv-3.4.11
  <span class="nb">mkdir </span>build
  <span class="nb">cd </span>build

  <span class="c"># Run cmake - Check XNect readme.md for flags</span>
  cmake <span class="nt">-D</span> <span class="nv">CMAKE_BUILD_TYPE</span><span class="o">=</span>RELEASE <span class="nt">-D</span> <span class="nv">CMAKE_INSTALL_PREFIX</span><span class="o">=</span>/usr/local <span class="nt">-D</span> <span class="nv">INSTALL_C_EXAMPLES</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">INSTALL_PYTHON_EXAMPLES</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">OPENCV_EXTRA_MODULES_PATH</span><span class="o">=</span>/home/anil/Documents/xNect/opencv_contrib-3.4.11/modules <span class="nt">-D</span> <span class="nv">BUILD_EXAMPLES</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">WITH_TBB</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">BUILD_NEW_PYTHON_SUPPORT</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">WITH_V4L</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">WITH_QT</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">WITH_OPENGL</span><span class="o">=</span>ON <span class="nt">-D</span> <span class="nv">BUILD_TIFF</span><span class="o">=</span>ON ..

  make <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span>
  <span class="nb">sudo </span>make <span class="nb">install
  sudo </span>ldconfig
</code></pre></div></div>

<p>Once installtion completed, check it</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python
<span class="o">&gt;&gt;&gt;</span> import cv2
<span class="o">&gt;&gt;&gt;</span> cv2.__version__
<span class="s1">'3.4.11'</span>
</code></pre></div></div>

<h4 id="2-installing-protobuf">2. installing protobuf</h4>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>autoconf automake libtool curl make g++ unzip <span class="nt">-y</span>
git clone https://github.com/google/protobuf.git
<span class="nb">cd </span>protobuf
git submodule update <span class="nt">--init</span> <span class="nt">--recursive</span>
./autogen.sh
./configure <span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">"-fPIC"</span> <span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-fPIC"</span>  <span class="o">(</span>Why ? I dont know - Check XNect Readme<span class="o">)</span>
<span class="nb">sudo </span>make <span class="nb">install
sudo </span>ldconfig
</code></pre></div></div>

<h4 id="3-installing-boost-1580">3. installing boost 1.58.0</h4>
<p>download  boost from <a href="https://www.boost.org/users/history/">here</a></p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tar </span>xvzf boost-1.58.tar
<span class="nb">cd </span>boost-1.58/tools/build
/bootstrap.sh <span class="nt">--prefix</span><span class="o">=</span>path/to/installation/prefix
./b2 <span class="nb">install</span>
</code></pre></div></div>
<ul>
  <li>Add PREFIX/bin to your PATH environment variable.</li>
</ul>

<h4 id="4-installing-caffe">4. installing caffe</h4>
<p>BVLC GitHub repository and grab the latest version of Caffe</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/BVLC/caffe.git
<span class="nb">cd </span>caffe
<span class="c">#copy make file </span>
<span class="nb">cp </span>Makefile.config.example Makefile.config
</code></pre></div></div>

<p>and make the following edits to <em>Makefile.config</em> - these are used to specify that we need to install caffe with GPU and CUDA support</p>

<div class="language-config highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># cuDNN acceleration switch (uncomment to build with cuDNN).
</span><span class="n">USE_CUDNN</span> := <span class="m">1</span>

<span class="c"># Uncomment if you're using OpenCV 3
</span><span class="n">OPENCV_VERSION</span> := <span class="m">3</span>

<span class="c"># We need to be able to find Python.h and numpy/arrayobject.h.
</span><span class="n">PYTHON_INCLUDE</span> := /<span class="n">usr</span>/<span class="n">include</span>/<span class="n">python2</span>.<span class="m">7</span> \
        /<span class="n">usr</span>/<span class="n">local</span>/<span class="n">lib</span>/<span class="n">python2</span>.<span class="m">7</span>/<span class="n">dist</span>-<span class="n">packages</span>/<span class="n">numpy</span>/<span class="n">core</span>/<span class="n">include</span>

<span class="c"># Uncomment to support layers written in Python (will link against    Python libs)
</span><span class="n">WITH_PYTHON_LAYER</span> := <span class="m">1</span>

<span class="c"># Whatever else you find you need goes here.
</span><span class="n">INCLUDE_DIRS</span> := $(<span class="n">PYTHON_INCLUDE</span>) /<span class="n">usr</span>/<span class="n">local</span>/<span class="n">include</span> /<span class="n">usr</span>/<span class="n">include</span>/<span class="n">hdf5</span>/<span class="n">serial</span>
<span class="n">LIBRARY_DIRS</span> := $(<span class="n">PYTHON_LIB</span>) /<span class="n">usr</span>/<span class="n">local</span>/<span class="n">lib</span> /<span class="n">usr</span>/<span class="n">lib</span> /<span class="n">usr</span>/<span class="n">lib</span>/<span class="n">x86_64</span>-<span class="n">linux</span>-<span class="n">gnu</span>/<span class="n">hdf5</span>/<span class="n">serial</span>/
</code></pre></div></div>

<p>and based on the cuda version you are using uncomment architectures</p>

<div class="language-config highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># CUDA architecture setting: going with all of them.
# For CUDA &lt; 6.0, comment the *_50 through *_61 lines for compatibility.
# For CUDA &lt; 8.0, comment the *_60 and *_61 lines for compatibility.
# For CUDA &gt;= 9.0, comment the *_20 and *_21 lines for compatibility.
</span><span class="n">CUDA_ARCH</span> := 
		<span class="c"># -gencode arch=compute_20,code=sm_20 \
</span>		<span class="c"># -gencode arch=compute_20,code=sm_21 \
</span>		-<span class="n">gencode</span> <span class="n">arch</span>=<span class="n">compute_30</span>,<span class="n">code</span>=<span class="n">sm_30</span> \
		-<span class="n">gencode</span> <span class="n">arch</span>=<span class="n">compute_35</span>,<span class="n">code</span>=<span class="n">sm_35</span> \
		-<span class="n">gencode</span> <span class="n">arch</span>=<span class="n">compute_50</span>,<span class="n">code</span>=<span class="n">sm_50</span> \
		-<span class="n">gencode</span> <span class="n">arch</span>=<span class="n">compute_52</span>,<span class="n">code</span>=<span class="n">sm_52</span> \
		-<span class="n">gencode</span> <span class="n">arch</span>=<span class="n">compute_60</span>,<span class="n">code</span>=<span class="n">sm_60</span> \
		-<span class="n">gencode</span> <span class="n">arch</span>=<span class="n">compute_61</span>,<span class="n">code</span>=<span class="n">sm_61</span> \
		-<span class="n">gencode</span> <span class="n">arch</span>=<span class="n">compute_61</span>,<span class="n">code</span>=<span class="n">compute_61</span>
</code></pre></div></div>
<h5 id="41-removing-clip-layer-and-adding-other-necessary-files">4.1 Removing clip layer and adding other necessary files</h5>
<p>I’m just copy + pasting steps/info in XNect readme.md document. Please refer document for more info (I’m not sure whether I can add that Info here are not due to licencing issues)</p>
<ol>
  <li>Copy folders from XNect source to caffe (Include and src)</li>
  <li>Make necessary changes to <em>caffe.proto</em> ( Need to add extra layers )</li>
  <li>Add new layer description</li>
  <li>Remove cliplayer from caffe - incluing .hpp , .cpp files</li>
</ol>

<h5 id="42-compile-caffe">4.2 compile caffe</h5>
<p>API comes with gcc-6.4 support , I’m unable to compile this with current gcc in my system i.e gcc-9, so In order to specify different compiler for gcc<br />
<a href="https://stackoverflow.com/questions/17275348/how-to-specify-new-gcc-path-for-cmake">ref</a></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">CC</span><span class="o">=</span>/usr/local/bin/gcc-6.4
<span class="nb">export </span><span class="nv">CXX</span><span class="o">=</span>/usr/local/bin/g++-6.4
<span class="c">#cmake /path/to/your/project</span>
<span class="c">#make</span>
</code></pre></div></div>
<p>Run cmake and make for caffe</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmake <span class="nt">-DProtobuf_LIBRARY_DEBUG</span><span class="o">=</span>/home/anil/Documents/xNect/protobuf/src/.libs/libprotobuf.so <span class="nt">-DProtobuf_PROTOC_EXECUTABLE</span><span class="o">=</span>/home/anil/Documents/xNect/protobuf/src/.libs/protoc <span class="nt">-DProtobuf_LIBRARY_RELEASE</span><span class="o">=</span>/home/anil/Documents/xNect/protobuf/src/.libs/libprotobuf.a  <span class="nt">-DProtobuf_LITE_LIBRARY_RELEASE</span><span class="o">=</span>/home/anil/Documents/xNect/protobuf/src/.libs/libprotobuf-lite.a <span class="nt">-DBOOST_INCLUDEDIR</span><span class="o">=</span>/usr/include/boost/  <span class="nt">-DBOOST_LIBRARYDIR</span><span class="o">=</span>/home/anil/Documents/xNect/boost/lib <span class="nt">-DProtobuf_INCLUDE_DIR</span><span class="o">=</span>/home/anil/Documents/xNect/protobuf/src/ <span class="nt">-DProtobuf_PROTOC_LIBRARY_RELEASE</span><span class="o">=</span>/home/anil/Documents/xNect/protobuf/src/.libs/libprotoc.so ..

make all <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span> <span class="o">&amp;&amp;</span> make <span class="nb">test</span> <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span> <span class="o">&amp;&amp;</span> make runtest <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span> <span class="o">&amp;&amp;</span> make pycaffe <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span>
</code></pre></div></div>

<p>Once done, Add follwing to .bashrc</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export PYTHONPATH=/home/anil/Documents/xNect/caffe/python:$PYTHONPATH
</code></pre></div></div>

<p>check caffe</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python
<span class="o">&gt;&gt;&gt;</span> import caffe
</code></pre></div></div>

<h5 id="build-project-and-run-demo">build project and run demo</h5>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmake <span class="nt">-DOpenCV_DIR</span><span class="o">=</span>/usr/share/opencv  <span class="nt">-DCaffe_DIR</span><span class="o">=</span>/home/anil/Documents/xNect/caffe/build ..
make <span class="nt">-j</span><span class="si">$(</span><span class="nb">nproc</span><span class="si">)</span>
<span class="nb">cd</span> ../bin/Release
./XNECT
</code></pre></div></div>

<h5 id="references">References</h5>
<ol>
  <li>I found a nice article about <a href="https://chunml.github.io/ChunML.github.io/project/Installing-Caffe-Ubuntu/">installing caffe in ubuntu</a>.</li>
  <li><a href="https://gist.github.com/diegopacheco/cd795d36e6ebcd2537cd18174865887b">Protobuf installation</a></li>
  <li><a href="https://www.boost.org/doc/libs/1_66_0/more/getting_started/unix-variants.html">Boost 1.58 Installation</a></li>
</ol>

    



<div class="post-tags">
  
    
    <a href="/tags.html#machine-learning">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Machine Learning</span>
    </a>
  
</div>
  </div>

  
  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/phd/publication/projects/2024/02/19/privacy-framework-paper.html">
            Towards A Framework for Privacy-Preserving Pedestrian Analysis
            <small>19 Feb 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/hiking/travel/2024/02/18/bray.html">
            Bray To Graystones- Ireland
            <small>18 Feb 2024</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/phd/publication/projects/2024/02/15/smpl-paper.html">
            SMPL-based 3D Pedestrian Pose Prediction 
            <small>15 Feb 2024</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
